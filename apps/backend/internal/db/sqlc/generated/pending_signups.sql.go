// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: pending_signups.sql

package sqlc

import (
	"context"

	"github.com/google/uuid"
	"github.com/jackc/pgx/v5/pgtype"
)

const createPendingSignup = `-- name: CreatePendingSignup :one
INSERT INTO pending_signups (full_name, email, display_name)
VALUES ($1, $2, $3)
RETURNING id, full_name, email, display_name, email_verified_at, status, expires_at, created_at, updated_at, deleted_at
`

type CreatePendingSignupParams struct {
	FullName    pgtype.Text `json:"full_name"`
	Email       pgtype.Text `json:"email"`
	DisplayName *string     `json:"display_name"`
}

func (q *Queries) CreatePendingSignup(ctx context.Context, arg CreatePendingSignupParams) (PendingSignup, error) {
	row := q.db.QueryRow(ctx, createPendingSignup, arg.FullName, arg.Email, arg.DisplayName)
	var i PendingSignup
	err := row.Scan(
		&i.ID,
		&i.FullName,
		&i.Email,
		&i.DisplayName,
		&i.EmailVerifiedAt,
		&i.Status,
		&i.ExpiresAt,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeletedAt,
	)
	return i, err
}

const getPendingSignupByEmail = `-- name: GetPendingSignupByEmail :one
SELECT id, full_name, email, display_name, email_verified_at, status, expires_at, created_at, updated_at, deleted_at FROM pending_signups WHERE email = $1 AND deleted_at IS NULL AND status = 'pending' AND email_verified_at IS NULL AND expires_at > NOW()
`

func (q *Queries) GetPendingSignupByEmail(ctx context.Context, email pgtype.Text) (PendingSignup, error) {
	row := q.db.QueryRow(ctx, getPendingSignupByEmail, email)
	var i PendingSignup
	err := row.Scan(
		&i.ID,
		&i.FullName,
		&i.Email,
		&i.DisplayName,
		&i.EmailVerifiedAt,
		&i.Status,
		&i.ExpiresAt,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeletedAt,
	)
	return i, err
}

const getPendingSignupByID = `-- name: GetPendingSignupByID :one
SELECT id, full_name, email, display_name, email_verified_at, status, expires_at, created_at, updated_at, deleted_at FROM pending_signups WHERE id = $1 AND deleted_at IS NULL AND status = 'pending' AND email_verified_at IS NULL AND expires_at > NOW()
`

func (q *Queries) GetPendingSignupByID(ctx context.Context, id uuid.UUID) (PendingSignup, error) {
	row := q.db.QueryRow(ctx, getPendingSignupByID, id)
	var i PendingSignup
	err := row.Scan(
		&i.ID,
		&i.FullName,
		&i.Email,
		&i.DisplayName,
		&i.EmailVerifiedAt,
		&i.Status,
		&i.ExpiresAt,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeletedAt,
	)
	return i, err
}

const updatePendingSignup = `-- name: UpdatePendingSignup :one
UPDATE pending_signups SET email_verified_at = $1 WHERE id = $2 AND deleted_at IS NULL AND status = 'pending' AND email_verified_at IS NULL AND expires_at > NOW() RETURNING id, full_name, email, display_name, email_verified_at, status, expires_at, created_at, updated_at, deleted_at
`

type UpdatePendingSignupParams struct {
	EmailVerifiedAt pgtype.Timestamp `json:"email_verified_at"`
	ID              uuid.UUID        `json:"id"`
}

func (q *Queries) UpdatePendingSignup(ctx context.Context, arg UpdatePendingSignupParams) (PendingSignup, error) {
	row := q.db.QueryRow(ctx, updatePendingSignup, arg.EmailVerifiedAt, arg.ID)
	var i PendingSignup
	err := row.Scan(
		&i.ID,
		&i.FullName,
		&i.Email,
		&i.DisplayName,
		&i.EmailVerifiedAt,
		&i.Status,
		&i.ExpiresAt,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeletedAt,
	)
	return i, err
}
